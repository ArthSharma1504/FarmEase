<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Our App</title>
   <link rel="stylesheet" href="{{url_for('static',filename='styles/welcome.css')}}">
</head>
<body>

    <video autoplay muted loop>
        <source src="{{ url_for('static', filename='videos/old.mp4') }}" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <div class="next-button" onclick="window.location.href='{{ url_for('my_Profile') }}';">
        <h1>मेरी प्रोफाइल</h1>
        <p>मम कार्याणि</p>
    </div>

    <div class="container">
        <div class="option-box" onclick="window.location.href='{{ url_for('show_weather') }}';">
            <h1>मौसम दिखाएं</h1>
            <p>मौसम का पूर्वानुमान देखने के लिए क्लिक करें।</p>
        </div>
        
        <div class="option-box" onclick="window.location.href='{{ url_for('crop_recommendations') }}';">
            <h1>फसल की जानकारी</h1>
            <p>मिट्टी की परत विवरण देखने के लिए क्लिक करें।</p>
        </div>
        
        <div class="option-box" onclick="window.location.href='{{ url_for('government_schemes') }}';">
            <h1>सरकारी योजनाएँ</h1>
            <p>सरकारी योजनाओं का पता लगाने के लिए क्लिक करें।</p>
        </div>
    </div>

    <!-- Display the logged-in user's details -->
    {% if username %}
    <div class="user-info">
        Logged in as: {{ username }} |
        <a href="{{ url_for('logout') }}" style="color: #fff;">Logout</a>
    </div>
    {% else %}
    <div class="user-info">
        <a href="{{ url_for('login') }}" style="color: #fff;">Login</a> |
        <a href="{{ url_for('register') }}" style="color: #fff;">Register</a>
    </div>
    {% endif %}

    <div class="notification-bell">
        <div class="bell-icon" id="bell-icon"></div>
        <div class="notification-popup" id="notification-popup">
            <h4>Weather Updates</h4>
            <div id="weather-notification">No new notifications</div>
        </div>
    </div>

    <script>
        // Toggle the notification popup
        document.getElementById('bell-icon').addEventListener('click', function () {
            const popup = document.getElementById('notification-popup');
            popup.classList.toggle('visible');
        });

        // Function to check for new weather updates and show notification
        function checkWeatherNotification() {
            fetch('{{ url_for("get_weather_notifications") }}')
                .then(response => response.json())
                .then(data => {
                    if (data.has_new_update) {
                        document.getElementById('bell-icon').classList.add('alert');
                        document.getElementById('weather-notification').innerText = data.notification_message;
                    }
                });
        }

        // Periodically check for new notifications
        setInterval(checkWeatherNotification, 60000); // Check every 60 seconds
    </script>

</body>
</html>
